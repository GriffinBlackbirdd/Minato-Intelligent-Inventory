<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minato Enterprises - Document Processor & Billing System</title>
    <link rel="stylesheet" href="/static/style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div class="app-container">
        <!-- Navigation Header -->
        <nav class="nav-header">
            <div class="nav-content">
                <div class="brand">
                    <i class="fas fa-file-invoice brand-icon"></i>
                    <span class="brand-name">Minato Enterprises</span>
                </div>
                <div class="nav-subtitle">Intelligent Document Processing & Real-time Billing System</div>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <div class="container">
                <!-- Hero Section -->
                <section class="hero-section">
                    <div class="hero-content">
                        <h1 class="hero-title">
                            <i class="fas fa-search"></i>
                            Document Processor & Real-time Billing System
                        </h1>
                        <p class="hero-description">
                            Smart customer search, automated document extraction, and real-time billing generation with tax calculations
                        </p>
                    </div>
                </section>

                <!-- Processing Steps -->
                <div class="steps-container">
                    <!-- Step 1: Customer Search -->
                    <div class="step-card active" id="searchCard">
                        <div class="step-header">
                            <div class="step-indicator">
                                <span class="step-number">1</span>
                            </div>
                            <div class="step-title">
                                <h2>Customer Search</h2>
                                <p>Type customer name for instant suggestions</p>
                            </div>
                        </div>

                        <div class="search-container">
                            <div class="search-input-wrapper">
                                <div class="input-wrapper">
                                    <i class="fas fa-user input-icon"></i>
                                    <input
                                        type="text"
                                        id="customerSearch"
                                        name="customerSearch"
                                        placeholder="Start typing customer name (e.g., Nandu)"
                                        class="form-input"
                                        autocomplete="off"
                                    >
                                    <div class="search-loading" id="searchLoading" style="display: none;">
                                        <i class="fas fa-spinner fa-spin"></i>
                                    </div>
                                </div>

                                <!-- Suggestions Dropdown -->
                                <div class="suggestions-dropdown" id="suggestionsDropdown" style="display: none;">
                                    <div class="suggestions-list" id="suggestionsList">
                                        <!-- Suggestions will be populated here -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 2: Information Extraction -->
                    <div class="step-card" id="extractionCard" style="display: none;">
                        <div class="step-header">
                            <div class="step-indicator">
                                <span class="step-number">2</span>
                            </div>
                            <div class="step-title">
                                <h2>Information Extraction</h2>
                                <p>Extracting and processing customer documents</p>
                            </div>
                        </div>

                        <!-- Fetching State -->
                        <div class="fetching-container" id="fetchingContainer">
                            <div class="fetching-animation">
                                <div class="fetching-spinner">
                                    <div class="spinner-ring"></div>
                                    <div class="spinner-ring"></div>
                                    <div class="spinner-ring"></div>
                                </div>
                                <h3>Fetching Information</h3>
                                <p>Please wait while we extract customer details from documents...</p>
                                <div class="fetching-progress">
                                    <div class="progress-bar">
                                        <div class="progress-fill" id="progressFill"></div>
                                    </div>
                                    <span class="progress-text" id="progressText">Initializing...</span>
                                </div>
                            </div>
                        </div>

                        <!-- Results and Edit State -->
                        <div class="extraction-results" id="extractionResults" style="display: none;">
                            <div class="customer-info-section">
                                <div class="customer-header">
                                    <div class="customer-avatar">
                                        <i class="fas fa-user"></i>
                                    </div>
                                    <div class="customer-details">
                                        <h3 class="customer-title" id="customerTitle">Customer Information</h3>
                                        <p class="customer-subtitle" id="customerSubtitle">Extracted and editable details</p>
                                    </div>
                                    <div class="edit-toggle">
                                        <button class="btn-edit" id="editToggleBtn">
                                            <i class="fas fa-edit"></i>
                                            Edit
                                        </button>
                                    </div>
                                </div>

                                <div class="info-grid">
                                    <div class="info-card">
                                        <label for="editName" class="info-label">
                                            <i class="fas fa-user"></i>
                                            Customer Name
                                        </label>
                                        <div class="info-display" id="displayName">-</div>
                                        <input type="text" id="editName" class="info-edit" style="display: none;">
                                    </div>

                                    <div class="info-card">
                                        <label for="editAadhaar" class="info-label">
                                            <i class="fas fa-id-card"></i>
                                            Aadhaar Number
                                        </label>
                                        <div class="info-display" id="displayAadhaar">-</div>
                                        <input type="text" id="editAadhaar" class="info-edit" style="display: none;">
                                    </div>

                                    <div class="info-card full-width">
                                        <label for="editAddress" class="info-label">
                                            <i class="fas fa-map-marker-alt"></i>
                                            Address
                                        </label>
                                        <div class="info-display" id="displayAddress">-</div>
                                        <textarea id="editAddress" class="info-edit" rows="3" style="display: none;"></textarea>
                                    </div>

                                    <div class="info-card">
                                        <label for="editMobile" class="info-label">
                                            <i class="fas fa-phone"></i>
                                            Mobile Number
                                        </label>
                                        <div class="info-display" id="displayMobile">-</div>
                                        <input type="text" id="editMobile" class="info-edit" style="display: none;">
                                    </div>

                                    <div class="info-card">
                                        <label for="editFolder" class="info-label">
                                            <i class="fas fa-folder"></i>
                                            Folder Reference
                                        </label>
                                        <div class="info-display" id="displayFolder">-</div>
                                        <input type="text" id="editFolder" class="info-edit" style="display: none;" readonly>
                                    </div>
                                </div>

                                <div class="action-buttons" id="editActions" style="display: none;">
                                    <button class="btn btn-success" id="saveChangesBtn">
                                        <i class="fas fa-save"></i>
                                        Save Changes
                                    </button>
                                    <button class="btn btn-outline" id="cancelEditBtn">
                                        <i class="fas fa-times"></i>
                                        Cancel
                                    </button>
                                </div>

                                <div class="action-buttons" id="defaultActions">
                                    <button class="btn btn-primary" id="proceedToBillBtn">
                                        <i class="fas fa-file-invoice"></i>
                                        Proceed to Bill
                                    </button>
                                    <button class="btn btn-outline" id="backToSearchBtn">
                                        <i class="fas fa-arrow-left"></i>
                                        Back to Search
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 3: Real-time Billing System -->
                    <div class="step-card" id="billingCard" style="display: none;">
                        <div class="step-header">
                            <div class="step-indicator">
                                <span class="step-number">3</span>
                            </div>
                            <div class="step-title">
                                <h2>Real-time Billing System</h2>
                                <p>Configure billing details with real-time tax calculations</p>
                            </div>
                        </div>

                        <div class="billing-content">
                            <!-- Customer Summary -->
                            <div class="customer-summary">
                                <h4><i class="fas fa-user-circle"></i> Customer Information</h4>
                                <div class="summary-grid">
                                    <div class="summary-item">
                                        <span class="summary-label">Name:</span>
                                        <span class="summary-value" id="billCustomerName">-</span>
                                    </div>
                                    <div class="summary-item">
                                        <span class="summary-label">Aadhaar:</span>
                                        <span class="summary-value" id="billCustomerAadhaar">-</span>
                                    </div>
                                    <div class="summary-item">
                                        <span class="summary-label">Mobile:</span>
                                        <span class="summary-value" id="billCustomerMobile">-</span>
                                    </div>
                                    <div class="summary-item full-width">
                                        <span class="summary-label">Address:</span>
                                        <span class="summary-value" id="billCustomerAddress">-</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Finance Firm Section -->
                            <div class="selection-section">
                                <div class="section-header">
                                    <h4><i class="fas fa-building"></i> Finance Firm (Optional)</h4>
                                    <p>Enter finance firm name if applicable</p>
                                </div>
                                <div class="finance-input-group">
                                    <input type="text" id="financeFirmInput" placeholder="Enter finance firm name (optional)" class="finance-input">
                                </div>
                            </div>

                            <!-- Price Input Section -->
                            <div class="selection-section">
                                <div class="section-header">
                                    <h4><i class="fas fa-rupee-sign"></i> Price & Tax Configuration</h4>
                                    <p>Enter the base price and configure tax settings</p>
                                </div>

                                <div class="price-tax-grid">
                                    <div class="price-input-group">
                                        <label for="priceInput">Base Price (₹)</label>
                                        <input type="number" id="priceInput" placeholder="127000" class="price-input" min="0" step="0.01">
                                    </div>

                                    <div class="tax-config-group">
                                        <div class="igst-checkbox-wrapper">
                                            <label class="checkbox-label">
                                                <input type="checkbox" id="igstCheckbox" class="igst-checkbox">
                                                <span class="checkbox-custom"></span>
                                                <span class="checkbox-text">Apply IGST (5%) instead of CGST+SGST</span>
                                            </label>
                                        </div>
                                    </div>
                                </div>

                                <!-- Tax Calculation Display -->
                                <div class="tax-calculation-display" id="taxCalculationDisplay" style="display: none;">
                                    <div class="tax-breakdown">
                                        <div class="tax-row">
                                            <span class="tax-label">Base Amount:</span>
                                            <span class="tax-value" id="baseAmountDisplay">₹0.00</span>
                                        </div>
                                        <div class="tax-row" id="cgstRow">
                                            <span class="tax-label">CGST (2.5%):</span>
                                            <span class="tax-value" id="cgstDisplay">₹0.00</span>
                                        </div>
                                        <div class="tax-row" id="sgstRow">
                                            <span class="tax-label">SGST (2.5%):</span>
                                            <span class="tax-value" id="sgstDisplay">₹0.00</span>
                                        </div>
                                        <div class="tax-row" id="igstRow" style="display: none;">
                                            <span class="tax-label">IGST (5%):</span>
                                            <span class="tax-value" id="igstDisplay">₹0.00</span>
                                        </div>
                                        <div class="tax-row">
                                            <span class="tax-label">Round Off:</span>
                                            <span class="tax-value" id="roundOffDisplay">₹0.00</span>
                                        </div>
                                        <div class="tax-row total-row">
                                            <span class="tax-label">Total Amount:</span>
                                            <span class="tax-value total-amount" id="totalAmountDisplay">₹0.00</span>
                                        </div>
                                        <div class="amount-words" id="amountWordsDisplay">
                                            Amount in words: <span id="amountWordsText">Zero</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Real-time Chassis Selection -->
                            <div class="selection-section">
                                <div class="section-header">
                                    <h4><i class="fas fa-car"></i> Chassis Selection</h4>
                                    <p>Type chassis number or model name to filter results</p>
                                </div>
                                <div class="filter-group">
                                    <div class="filter-input-wrapper">
                                        <input type="text" id="chassisFilter" placeholder="Type chassis number or model..." class="filter-input">
                                        <div class="filter-loading" id="chassisLoading" style="display: none;">
                                            <i class="fas fa-spinner fa-spin"></i>
                                        </div>
                                    </div>
                                    <div class="filter-results" id="chassisResults" style="display: none;">
                                        <div class="results-list" id="chassisResultsList"></div>
                                    </div>
                                </div>
                                <div class="selected-item" id="selectedChassis" style="display: none;">
                                    <div class="selected-header">
                                        <span>Selected Chassis:</span>
                                        <button class="btn-remove" onclick="clearSelectedChassis()">
                                            <i class="fas fa-times"></i>
                                        </button>
                                    </div>
                                    <div class="selected-details" id="selectedChassisDetails"></div>
                                </div>
                            </div>

                            <!-- Real-time Battery Selection -->
                            <div class="selection-section">
                                <div class="section-header">
                                    <h4><i class="fas fa-battery-full"></i> Battery Selection</h4>
                                    <p>Type battery serial number or brand to filter results</p>
                                </div>
                                <div class="filter-group">
                                    <div class="filter-input-wrapper">
                                        <input type="text" id="batteryFilter" placeholder="Type battery serial or brand..." class="filter-input">
                                        <div class="filter-loading" id="batteryLoading" style="display: none;">
                                            <i class="fas fa-spinner fa-spin"></i>
                                        </div>
                                    </div>
                                    <div class="filter-results" id="batteryResults" style="display: none;">
                                        <div class="results-list" id="batteryResultsList"></div>
                                    </div>
                                </div>
                                <div class="selected-items" id="selectedBatteries" style="display: none;">
                                    <div class="selected-header">
                                        <span>Selected Batteries:</span>
                                        <button class="btn-clear" onclick="clearAllBatteries()">
                                            <i class="fas fa-trash"></i>
                                            Clear All
                                        </button>
                                    </div>
                                    <div class="selected-list" id="selectedBatteriesList"></div>
                                </div>
                            </div>

                            <!-- HSN Code Selection -->
                            <div class="selection-section">
                                <div class="section-header">
                                    <h4><i class="fas fa-code"></i> HSN Code Selection</h4>
                                    <p>Select the appropriate HSN code for billing</p>
                                </div>
                                <div class="hsn-selection">
                                    <select id="hsnCodeSelect" class="hsn-select">
                                        <option value="">Select HSN Code</option>
                                        <option value="8703">8703 - Motor cars and other motor vehicles</option>
                                        <option value="8504">8504 - Electrical transformers, static converters</option>
                                        <option value="8507">8507 - Electric accumulators</option>
                                    </select>
                                </div>
                            </div>

                            <!-- Description Preview -->
                            <div class="description-preview" id="descriptionPreview" style="display: none;">
                                <div class="section-header">
                                    <h4><i class="fas fa-eye"></i> Bill Description Preview</h4>
                                    <p>This is how the description will appear on the bill</p>
                                </div>
                                <div class="preview-content" id="previewContent"></div>
                            </div>

                            <!-- Action Buttons -->
                            <div class="action-buttons">
                                <button class="btn btn-success" id="generateBillBtn" disabled>
                                    <i class="fas fa-file-invoice"></i>
                                    Generate Bill
                                </button>
                                <button class="btn btn-outline" id="backToReviewBtn">
                                    <i class="fas fa-arrow-left"></i>
                                    Back to Review
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Step 4: Final Results -->
                    <div class="step-card" id="resultsCard" style="display: none;">
                        <div class="step-header">
                            <div class="step-indicator success">
                                <i class="fas fa-check"></i>
                            </div>
                            <div class="step-title">
                                <h2>Processing Complete</h2>
                                <p>Document extraction and bill generation results</p>
                            </div>
                        </div>

                        <div id="resultsContent" class="results-content">
                            <!-- Results will be populated here -->
                        </div>

                        <div class="action-buttons">
                            <button id="resetBtn" class="btn btn-outline">
                                <i class="fas fa-plus"></i>
                                Process Another Customer
                            </button>
                        </div>
                    </div>

                    <!-- Error Display -->
                    <div class="step-card error" id="errorCard" style="display: none;">
                        <div class="step-header">
                            <div class="step-indicator error">
                                <i class="fas fa-exclamation-triangle"></i>
                            </div>
                            <div class="step-title">
                                <h2>Processing Error</h2>
                                <p>An issue occurred during processing</p>
                            </div>
                        </div>

                        <div class="error-content">
                            <div id="errorMessage" class="error-message"></div>
                        </div>

                        <div class="action-buttons">
                            <button id="errorResetBtn" class="btn btn-outline">
                                <i class="fas fa-arrow-left"></i>
                                Try Again
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="app-footer">
            <div class="footer-content">
                <div class="footer-brand">
                    <i class="fas fa-building"></i>
                    <span>&copy; 2025 Minato Enterprises. All rights reserved.</span>
                </div>
                <div class="footer-tech">
                    <span>Powered by Real-time Document Processing & Tax Calculation Technology</span>
                </div>
            </div>
        </footer>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay" style="display: none;">
        <div class="loading-content">
            <div class="loading-animation">
                <div class="loading-circle"></div>
                <div class="loading-circle"></div>
                <div class="loading-circle"></div>
            </div>
            <h3 id="loadingText">Processing Documents...</h3>
            <p>Please wait while we extract the information</p>
        </div>
    </div>

    <script src="/static/script.js"></script>
</body>
</html>